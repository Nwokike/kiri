{% load static %}
{% load pwa %}
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Kiri Research Labs{% endblock %}</title>
    <meta name="description"
        content="{% block meta_description %}Kiri Research Labs develops software platforms, AI-driven solutions, and digital research tools for data analytics, education, and social-impact initiatives.{% endblock %}">

    <!-- Local Fonts -->
    <link rel="preload" href="{% static 'fonts/inter-regular.woff2' %}" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="{% static 'fonts/inter-medium.woff2' %}" as="font" type="font/woff2" crossorigin>

    <!-- Font Awesome (Local) -->
    <link rel="stylesheet" href="{% static 'fontawesome/all.min.css' %}">

    <!-- Main Styles -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">

    <!-- Theme initialization (prevent flash) -->
    <script>
        (function () {
            const theme = localStorage.getItem('theme') || 'light';
            if (theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    {% progressive_web_app_meta %}
    {% block extra_css %}{% endblock %}
</head>

<body class="min-h-screen flex flex-col bg-white text-gray-900 antialiased theme-transition">

    {% include "partials/_header.html" %}

    <!-- Main Content -->
    <main class="flex-1">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            {% if messages %}
            <div class="mb-6 space-y-2">
                {% for message in messages %}
                <div
                    class="p-4 rounded-lg border text-sm
                    {% if message.tags == 'error' %}bg-red-50 border-red-200 text-red-700{% elif message.tags == 'success' %}bg-green-50 border-green-200 text-green-700{% else %}bg-blue-50 border-blue-200 text-blue-700{% endif %}">
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}

            {% block content %}{% endblock %}
        </div>
    </main>

    {% include "partials/_footer.html" %}
    {% include "partials/_mobile_nav.html" %}

    <!-- Scripts -->
    <script src="{% static 'js/htmx.min.js' %}" defer></script>
    <script src="{% static 'js/theme.js' %}" defer></script>
    {% block extra_js %}{% endblock %}
</body>

</html>