{% extends "base.html" %}
{% load static %}

{% block head %}
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.16.0">
{% endblock %}

{% block title %}Universal Translator | Project 0{% endblock %}

{% block content %}
<div class="p-4 max-w-4xl mx-auto">
    <div class="mb-8 text-center">
        <span class="text-xs font-mono font-bold uppercase text-[#198038] tracking-widest mb-2 block">Project 0
            (Alpha)</span>
        <h1 class="text-4xl md:text-5xl font-semibold text-[#161616] dark:text-white mb-4">Universal Translator</h1>
        <p class="text-lg text-[#525252] dark:text-[#a8a8a8] max-w-2xl mx-auto">
            Zero-Server Translation running entirely in your browser using
            <a href="https://huggingface.co/docs/transformers.js" target="_blank"
                class="text-[#0f62fe] hover:underline">Transformers.js</a>.
        </p>
    </div>

    <!-- Interface -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 bg-white border border-[#e0e0e0] p-6 md:p-8 dark:bg-[#262626] dark:border-[#393939]"
        id="translator-app">

        <!-- Input -->
        <div class="space-y-3">
            <div class="flex justify-between items-center">
                <label class="text-sm font-semibold text-[#161616] dark:text-white">Input Text</label>
                <select id="src-lang"
                    class="text-xs border border-[#e0e0e0] px-2 py-1 bg-white dark:bg-[#393939] dark:border-[#525252] dark:text-white">
                    <option value="en">English</option>
                    <option value="fr">French</option>
                    <option value="es">Spanish</option>
                    <option value="de">German</option>
                    <option value="it">Italian</option>
                    <option value="pt">Portuguese</option>
                    <option value="zh">Chinese</option>
                    <option value="ja">Japanese</option>
                </select>
            </div>
            <textarea id="input-text" rows="8"
                class="w-full p-4 border border-[#e0e0e0] bg-[#f4f4f4] resize-none focus:border-[#0f62fe] focus:outline-none dark:bg-[#393939] dark:border-[#525252] dark:text-white"
                placeholder="Type or paste text here..."></textarea>
            <div class="flex justify-between text-xs text-[#a8a8a8]">
                <span id="char-count">0 chars</span>
                <button id="clear-btn" class="hover:text-[#da1e28]">Clear</button>
            </div>
        </div>

        <!-- Output -->
        <div class="space-y-3">
            <div class="flex justify-between items-center">
                <label class="text-sm font-semibold text-[#161616] dark:text-white">Translation</label>
                <select id="tgt-lang"
                    class="text-xs border border-[#e0e0e0] px-2 py-1 bg-white dark:bg-[#393939] dark:border-[#525252] dark:text-white">
                    <option value="fr">French</option>
                    <option value="es">Spanish</option>
                    <option value="en">English</option>
                    <option value="de">German</option>
                    <option value="it">Italian</option>
                    <option value="pt">Portuguese</option>
                    <option value="zh">Chinese</option>
                    <option value="ja">Japanese</option>
                </select>
            </div>
            <div class="relative h-full">
                <textarea id="output-text" rows="8"
                    class="w-full p-4 border border-[#e0e0e0] bg-white resize-none dark:bg-[#393939] dark:border-[#525252] dark:text-white"
                    readonly placeholder="Translation will appear here..."></textarea>

                <!-- Loading Overlay -->
                <div id="loader"
                    class="absolute inset-0 bg-white/80 dark:bg-[#262626]/80 flex flex-col items-center justify-center hidden">
                    <i class="fas fa-circle-notch fa-spin text-[#0f62fe] text-3xl mb-3"></i>
                    <p class="text-sm font-medium text-[#525252] dark:text-[#a8a8a8]" id="loader-text">Loading Model...
                    </p>
                    <div class="w-48 h-1 bg-[#e0e0e0] mt-3 overflow-hidden dark:bg-[#393939]">
                        <div id="progress-bar" class="h-full bg-[#0f62fe] w-0 transition-all duration-300"></div>
                    </div>
                </div>
            </div>
            <div class="flex justify-end text-xs text-[#a8a8a8]">
                <button id="copy-btn" class="hover:text-[#0f62fe]"><i class="far fa-copy mr-1"></i> Copy</button>
            </div>
        </div>
    </div>

    <!-- Stats -->
    <div class="mt-8 grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
        <div class="p-4 bg-white border border-[#e0e0e0] dark:bg-[#262626] dark:border-[#393939]">
            <div class="text-xs text-[#a8a8a8] uppercase tracking-wider mb-1">Model</div>
            <div class="font-mono font-bold text-sm text-[#161616] dark:text-white">Xenova/nllb-200</div>
        </div>
        <div class="p-4 bg-white border border-[#e0e0e0] dark:bg-[#262626] dark:border-[#393939]">
            <div class="text-xs text-[#a8a8a8] uppercase tracking-wider mb-1">Size</div>
            <div class="font-mono font-bold text-sm text-[#161616] dark:text-white">~170 MB</div>
        </div>
        <div class="p-4 bg-white border border-[#e0e0e0] dark:bg-[#262626] dark:border-[#393939]">
            <div class="text-xs text-[#a8a8a8] uppercase tracking-wider mb-1">Device</div>
            <div class="font-mono font-bold text-sm text-[#198038]">WebGPU/WASM</div>
        </div>
        <div class="p-4 bg-white border border-[#e0e0e0] dark:bg-[#262626] dark:border-[#393939]">
            <div class="text-xs text-[#a8a8a8] uppercase tracking-wider mb-1">Privacy</div>
            <div class="font-mono font-bold text-sm text-[#198038]">100% Local</div>
        </div>
    </div>
</div>

<div class="h-16 md:hidden"></div>

<script type="module" src="{% static 'js/universal_translator.js' %}"></script>
{% endblock %}