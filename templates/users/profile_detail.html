{% extends "base.html" %}
{% load static %}

{% block title %}{{ profile_user.username }} | Kiri Profile{% endblock %}

{% block content %}
<div class="p-4 max-w-5xl mx-auto space-y-8">

    <!-- Profile Header -->
    <div class="bg-white border border-[#e0e0e0] p-6 md:p-8 dark:bg-[#262626] dark:border-[#393939]">
        <div class="flex flex-col md:flex-row gap-6 items-start md:items-center">

            <!-- Avatar -->
            <div class="shrink-0">
                {% if profile_user.github_avatar_url %}
                <img src="{{ profile_user.github_avatar_url }}" alt="{{ profile_user.username }}"
                    class="w-24 h-24 md:w-32 md:h-32 border-2 border-[#e0e0e0] object-cover dark:border-[#393939]">
                {% else %}
                <div
                    class="w-24 h-24 md:w-32 md:h-32 bg-[#f4f4f4] text-[#a8a8a8] flex items-center justify-center text-4xl font-bold dark:bg-[#393939] border border-[#e0e0e0] dark:border-[#525252]">
                    {{ profile_user.username|slice:":2"|upper }}
                </div>
                {% endif %}
            </div>

            <!-- Meta -->
            <div class="flex-1 space-y-2">
                <div class="flex items-center gap-3 flex-wrap">
                    <h1 class="text-2xl md:text-3xl font-semibold text-[#161616] dark:text-white">
                        {{ profile_user.username }}
                    </h1>
                    <span
                        class="px-2 py-0.5 text-xs font-mono font-medium border
                        {% if profile_user.role == 'core_team' %}bg-[#0f62fe] text-white border-[#0f62fe]
                        {% elif profile_user.role == 'researcher' %}bg-[#edf5ff] text-[#0f62fe] border-[#0f62fe]
                        {% else %}bg-[#f4f4f4] text-[#525252] border-[#e0e0e0] dark:bg-[#393939] dark:border-[#525252] dark:text-[#a8a8a8]{% endif %}">
                        {{ profile_user.get_role_display }}
                    </span>
                    {% if profile_user.is_verified %}
                    <span class="text-[#198038]" title="Verified Researcher"><i class="fas fa-check-circle"></i></span>
                    {% endif %}
                </div>

                {% if profile_user.bio %}
                <p class="text-[#525252] max-w-2xl dark:text-[#a8a8a8]">{{ profile_user.bio }}</p>
                {% endif %}

                <div class="flex items-center gap-4 text-sm text-[#a8a8a8] pt-2 flex-wrap">
                    {% if profile_user.github_username %}
                    <a href="https://github.com/{{ profile_user.github_username }}" target="_blank"
                        class="hover:text-[#161616] transition-colors dark:hover:text-white">
                        <i class="fab fa-github mr-1"></i> {{ profile_user.github_username }}
                    </a>
                    {% endif %}
                    {% if profile_user.website %}
                    <a href="{{ profile_user.website }}" target="_blank"
                        class="hover:text-[#161616] transition-colors dark:hover:text-white">
                        <i class="fas fa-link mr-1"></i> Website
                    </a>
                    {% endif %}
                    {% if profile_user.orcid_id %}
                    <span class="hover:text-[#161616] cursor-help dark:hover:text-white" title="ORCID iD">
                        <i class="fas fa-id-card mr-1"></i> {{ profile_user.orcid_id }}
                    </span>
                    {% endif %}
                    <span>
                        <i class="fas fa-code-branch mr-1"></i> {{ profile_user.github_public_repos }} Repos
                    </span>
                </div>
            </div>

            <!-- Actions -->
            {% if request.user == profile_user %}
            <div class="flex flex-col gap-2">
                <a href="#"
                    class="px-4 py-2 border border-[#e0e0e0] text-[#525252] text-xs hover:bg-[#f4f4f4] transition-colors dark:border-[#393939] dark:text-[#a8a8a8] dark:hover:bg-[#393939]">
                    <i class="fas fa-cog mr-1"></i> Settings
                </a>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Content Sections -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

        <!-- Projects -->
        <section class="space-y-4">
            <div class="flex items-center justify-between border-b border-[#e0e0e0] pb-2 dark:border-[#393939]">
                <h2 class="text-lg font-semibold text-[#161616] dark:text-white">Projects</h2>
                <span
                    class="text-xs font-mono bg-[#f4f4f4] px-2 py-1 text-[#525252] dark:bg-[#393939] dark:text-[#a8a8a8]">{{
                    projects|length }}</span>
            </div>

            {% if projects %}
            <div class="space-y-3">
                {% for project in projects %}
                <a href="{% url 'projects:detail' project.slug %}"
                    class="block p-4 border border-[#e0e0e0] bg-white hover:border-[#0f62fe] transition-colors group dark:bg-[#262626] dark:border-[#393939] dark:hover:border-[#0f62fe]">
                    <div class="flex justify-between items-start mb-1">
                        <h3
                            class="font-medium text-[#161616] group-hover:text-[#0f62fe] transition-colors dark:text-white">
                            {{ project.name }}</h3>
                        <div class="flex items-center gap-2 text-xs text-[#a8a8a8]">
                            <span class="flex items-center gap-1"><i class="fas fa-star text-[#f1c21b]"></i> {{
                                project.stars_count }}</span>
                        </div>
                    </div>
                    <p class="text-sm text-[#525252] line-clamp-2 mb-2 dark:text-[#a8a8a8]">{{ project.description }}
                    </p>
                    <div class="flex items-center gap-2">
                        {% if project.is_hot %}
                        <span
                            class="text-[10px] font-bold text-[#8e6a00] bg-[#f1c21b]/10 px-1.5 py-0.5 border border-[#f1c21b]/20">Trending</span>
                        {% endif %}
                        <span
                            class="text-[10px] bg-[#f4f4f4] px-2 py-0.5 text-[#525252] dark:bg-[#393939] dark:text-[#a8a8a8]">{{
                            project.language }}</span>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-8 border border-dashed border-[#e0e0e0] text-[#a8a8a8] dark:border-[#393939]">
                <p class="text-sm">No projects showcased yet.</p>
            </div>
            {% endif %}
        </section>

        <!-- Publications -->
        <section class="space-y-4">
            <div class="flex items-center justify-between border-b border-[#e0e0e0] pb-2 dark:border-[#393939]">
                <h2 class="text-lg font-semibold text-[#161616] dark:text-white">Publications</h2>
                <span
                    class="text-xs font-mono bg-[#f4f4f4] px-2 py-1 text-[#525252] dark:bg-[#393939] dark:text-[#a8a8a8]">{{
                    publications|length }}</span>
            </div>

            {% if publications %}
            <div class="space-y-3">
                {% for pub in publications %}
                <a href="{% url 'publications:detail' pub.slug %}"
                    class="block p-4 border border-[#e0e0e0] bg-white hover:border-[#0f62fe] transition-colors group dark:bg-[#262626] dark:border-[#393939] dark:hover:border-[#0f62fe]">
                    <h3
                        class="font-medium text-[#161616] group-hover:text-[#0f62fe] transition-colors mb-1 dark:text-white">
                        {{ pub.title }}</h3>
                    <p class="text-xs text-[#a8a8a8] mb-2">{{ pub.created_at|date:"M Y" }}</p>
                    <div class="flex items-center gap-2">
                        <span
                            class="text-[10px] font-mono bg-[#edf5ff] text-[#0f62fe] px-1.5 py-0.5 border border-[#0f62fe]/20">v{{
                            pub.version }}</span>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-8 border border-dashed border-[#e0e0e0] text-[#a8a8a8] dark:border-[#393939]">
                <p class="text-sm">No publications yet.</p>
            </div>
            {% endif %}
        </section>

        <!-- Contributions -->
        <section class="space-y-4 md:col-span-2">
            <div class="flex items-center justify-between border-b border-[#e0e0e0] pb-2 dark:border-[#393939]">
                <h2 class="text-lg font-semibold text-[#161616] dark:text-white">Contributions</h2>
                <span
                    class="text-xs font-mono bg-[#f4f4f4] px-2 py-1 text-[#525252] dark:bg-[#393939] dark:text-[#a8a8a8]">{{
                    contributions|length }}</span>
            </div>

            {% if contributions %}
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                {% for pub in contributions %}
                <a href="{% url 'publications:detail' pub.slug %}"
                    class="block p-4 border border-[#e0e0e0] bg-white hover:border-[#f1c21b] transition-colors group dark:bg-[#262626] dark:border-[#393939] dark:hover:border-[#f1c21b]">
                    <h3
                        class="font-medium text-[#161616] group-hover:text-[#f1c21b] transition-colors mb-1 dark:text-white">
                        {{ pub.title }}</h3>
                    <p class="text-xs text-[#a8a8a8]">Contributed to Research â€¢ {{ pub.created_at|date:"M Y" }}</p>
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </section>

    </div>
</div>

<div class="h-16 md:hidden"></div>
{% endblock %}